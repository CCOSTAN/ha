- alias: Cuckoo Clock
  hide_entity: true
  initial_state: true
  trigger:
  - platform: time
    minutes: 00
    seconds: 01
  - platform: time
    minutes: 30
    seconds: 01
  condition:
    condition: or
    conditions:
      - condition: and
        conditions:
          # 工作日
          - condition: time
            after: '06:59:00'
            before: '21:01:00'

          - condition: state
            entity_id: sensor.chinese_calendar
            state: 'workday'

      - condition: and
        conditions:
          # 节假日
          - condition: time
            after: '09:00:00'
            before: '22:30:00'

          - condition: state
            entity_id: sensor.chinese_calendar
            state: 'holiday'
  action:
    service: shell_command.play_clock
    data_template:
      text: >-
        {% if now().strftime("%M")|int == 30 %}'/home/pi/.homeassistant/sounds/cuckoo-clock-01.mp3'
        {% else %}'/home/pi/.homeassistant/sounds/cuckoo-clock.mp3'
        {% endif %}
